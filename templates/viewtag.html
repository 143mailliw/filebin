<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
        <title>Filebin</title>

        <!-- Bootstrap -->
        <link rel="stylesheet" href="/static/bootstrap/css/bootstrap.css"/>
        <link rel="stylesheet" href="/static/css/upload.css"/>
        <link rel="stylesheet" href="/static/css/custom.css"/>

        <script src="/static/js/showhide.js"></script>
        <script src="/static/js/upload.js"></script>
        <script>
            window.onload = function () {
                if (typeof FileReader == "undefined") alert ("Your browser is not supported. You will need to update to a mo    dern browser with File API support to upload files.");
                var fileCount = document.getElementById("fileCount");
                var fileList = document.getElementById("fileList");
                var fileDrop = document.body;
                var fileField = document.getElementById("fileField");
                var tag = "{{ .Tag.TagID }}";
                FileAPI = new FileAPI(
                    fileCount,
                    fileList,
                    fileDrop,
                    fileField,
                    tag
                );
                FileAPI.init();
                // Automatically start upload when using the drop zone
                fileDrop.ondrop = FileAPI.uploadQueue;
                // Automatically start upload when selecting files
                fileField.addEventListener("change", FileAPI.uploadQueue)
            }
        </script>
    </head>

    <body id="fileDrop">
        <div class="container-fluid">
            <nav class="navbar navbar-dark bg-inverse">
              <ul class="nav navbar-nav">
                <li class="nav-item active">
                   <div class="fileUpload nav-link active">
                       <span>Upload files</span>
                       <input type="file" class="upload" id="fileField"/ multiple>
                   </div>
                </li>
                {{ if .Files }}
                    <li class="nav-item active">
                      <a class="nav-link" href="/">New tag</a>
                    </li>
                {{ end }}
<!--
                <li class="nav-item">
                  <a class="nav-link" href="/api">API</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="/doc">Documentation</a>
                </li>
-->
                <div class="nav-item nav-link pull-right">
                    <div id="fileCount"></div>
                </div>
              </ul>
            </nav>

            <div class="row">
                <div class="col-sm-6">
                    <h1 class="display-4">
                        Filebin
                    </h1>
                </div>
                <div class="col-sm-6">
                    <div align="right">
                        <p>
                        <small class="text-muted pull-right">
                            {{ if .Files }}
                                {{ if eq (.Files | len) 1 }}
                                    This tag contains {{ .Files | len }} file.
                                {{ else }}
                                    This tag contains {{ .Files | len }} files.
                                {{ end }}
                                <br/>
                            {{ end }}
                             {{ if .LastUpdateReadable }}
                                 Last updated {{ .LastUpdateReadable }}.
                                 <br/>
                             {{ end }}
                             {{ if .ExpirationReadable }}
                                 Expires {{ .ExpirationReadable }}.
                             {{ end }}
                        </small>
                        </p>
                    </div>
                </div>
            </div>

            {{ if .Files }}
            {{ else }}
                <p class="lead">
                    Convenient file sharing on the web, without
                    registration. Simply upload files and share
                    the link. The files will expire after a while.
                </p>
                <p class="lead">
                    <strong>1.</strong> Click <em>Upload files</em> in
                    the top menu to upload, or drag and drop the files
                    into this browser window.
                </p>
                <p class="lead">
                    <strong>2.</strong> Wait until the uploads complete.
                </p>
                <p class="lead">
                    <strong>3.</strong> Distribute the URL from the
                    address bar to share access to the files.
                </p>
            {{ end }}


            <div class="table-responsive">
                <table class="table">
                    {{ if .Files }}
	                <thead class="thead">
                            <th>Filename</th>
                            <th>Size</th>
                            <th class="hidden-md-down">Type</th>
                            <th>Created</th>
	                </thead>
                    {{ end }}
	            <tbody id="fileList">
                        {{ range $index, $value := .Files }}
                            <tr>
                                <td><a href="/{{ .TagID }}/{{ .Filename }}">{{ .Filename }}</a></td>
                                <td>{{ .BytesReadable }}</td>
                                <td class="hidden-md-down">{{ .MIME }}</td>
                                <td>{{ .CreatedReadable }}</td>
                            </tr>
                        {{ end }}
	            <tbody>
                </table>
            </div>
        </div>
    </body>
</html>
